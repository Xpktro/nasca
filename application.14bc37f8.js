parcelRequire=function(e,r,n,t){var i="function"==typeof parcelRequire&&parcelRequire,o="function"==typeof require&&require;function u(n,t){if(!r[n]){if(!e[n]){var f="function"==typeof parcelRequire&&parcelRequire;if(!t&&f)return f(n,!0);if(i)return i(n,!0);if(o&&"string"==typeof n)return o(n);var c=new Error("Cannot find module '"+n+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[n][1][r]||r};var l=r[n]=new u.Module(n);e[n][0].call(l.exports,p,l,l.exports,this)}return r[n].exports;function p(e){return u(p.resolve(e))}}u.isParcelRequire=!0,u.Module=function(e){this.id=e,this.bundle=u,this.exports={}},u.modules=e,u.cache=r,u.parent=i,u.register=function(r,n){e[r]=[function(e,r){r.exports=n},{}]};for(var f=0;f<n.length;f++)u(n[f]);if(n.length){var c=u(n[n.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=c:"function"==typeof define&&define.amd?define(function(){return c}):t&&(this[t]=c)}return u}({"89/O":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=function(){function e(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}return function(t,n,a){return n&&e(t.prototype,n),a&&e(t,a),t}}();function t(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var n=function(){function n(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},a=e.fundamentalFrequency,o=void 0===a?440:a,r=e.fundamentalNote,i=void 0===r?69:r,u=e.pitchBendRangeCents,l=void 0===u?200:u;t(this,n),this.fundamentalFrequency=o,this.fundamentalNote=i,this.pitchBendRangeCents=l,this.intervals=[0,68,138,211,288,368,452,540,633,731,835,946,1064]}return e(n,[{key:"mod",value:function(e,t){return(e%t+t)%t}},{key:"frequencyToMIDI",value:function(e){var t=Math.log(e/440)/Math.log(2)*12+69,n=Math.round(t),a=Math.log(t/n)/Math.log(2)*1200;return[n,Math.round(8192*a/this.pitchBendRangeCents)+8192]}},{key:"addCents",value:function(e,t){return e*Math.pow(2,t/1200)}},{key:"noteToNasca",value:function(e,t){var n=e-this.fundamentalNote,a=this.mod(n,this.intervals.length),o=Math.floor(n/this.intervals.length),r=this.addCents(this.fundamentalFrequency*Math.pow(2,o),this.intervals[a]);return console.log(r),this.frequencyToMIDI(r)}}]),n}();exports.default=n;
},{}],"CGw3":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0});var e=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var n=[],i=!0,a=!1,s=void 0;try{for(var u,c=e[Symbol.iterator]();!(i=(u=c.next()).done)&&(n.push(u.value),!t||n.length!==t);i=!0);}catch(e){a=!0,s=e}finally{try{!i&&c.return&&c.return()}finally{if(a)throw s}}return n}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),t=function(){function e(e,t){for(var n=0;n<t.length;n++){var i=t[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(e,i.key,i)}}return function(t,n,i){return n&&e(t.prototype,n),i&&e(t,i),t}}(),n=require("./NascaScale"),i=a(n);function a(e){return e&&e.__esModule?e:{default:e}}function s(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}var u=function(){function n(e,t,a,u,c){var o=this,r=arguments.length>5&&void 0!==arguments[5]?arguments[5]:console.log;s(this,n),this.scale=new i.default,this.inputDeviceSelector=e,this.inputDeviceSelector.onchange=function(){return o.useSelectedDevices()},this.outputDeviceSelector=t,this.outputDeviceSelector.onchange=function(){return o.useSelectedDevices()},this.noteDisplay=a,this.frequencyDisplay=u,this.inputDevice={},this.outputDevice={},this.log=r,this.fundamentalNoteSet=!1,c.onclick=function(){return o.setFundamentalNote()},this.log("Requesting Browser MIDI access..."),navigator.requestMIDIAccess().then(function(e){return o.accessGranted(e)}).catch(function(e){return r("Could not get browser MIDI access. Error: ",e)})}return t(n,[{key:"accessGranted",value:function(e){var t=this;this.log("MIDI access granted."),this.access=e,this.access.onstatechange=function(){return t.log("Updating device list.")||t.updateDevices()||t.useSelectedDevices()},this.updateDevices(),this.useSelectedDevices()}},{key:"updateDevices",value:function(){var e=this;this.inputDeviceSelector.innerHTML="",this.access.inputs.forEach(function(t){var n=document.createElement("option");n.value=t.id,n.innerHTML=t.name,t.id===e.inputDevice.id&&(n.selected=!0),e.inputDeviceSelector.appendChild(n)}),this.outputDeviceSelector.innerHTML="",this.access.outputs.forEach(function(t){var n=document.createElement("option");n.value=t.id,n.innerHTML=t.name,t.id===e.outputDevice.id&&(n.selected=!0),e.outputDeviceSelector.appendChild(n)})}},{key:"useSelectedDevices",value:function(){var e=this,t=this.inputDeviceSelector.value,n=this.outputDeviceSelector.value;this.inputDevice=this.access.inputs.get(t),this.outputDevice=this.access.outputs.get(n),this.access.inputs.forEach(function(e){return e.onmidimessage=null}),this.inputDevice.onmidimessage=function(t){return e.onMIDIMessage(t)}}},{key:"midiToFrequency",value:function(e){return 440*Math.pow(2,(e-69)/12)}},{key:"setFundamentalNote",value:function(){this.fundamentalNoteSet||(this.fundamentalNoteSet=!0,this.log("Press the note key you want to set as the new fundamental tone."))}},{key:"onMIDIMessage",value:function(t){if(!(176==(176&t.data[0])&&[6,38].includes(t.data[1])||224==(224&t.data[0]))){console.log("data:",t.data,"hex:",t.data[0].toString(16),t.data[1].toString(16),t.data[2].toString(16));var n=144==(144&t.data[0]),i=128==(128&t.data[0]);if(n&&this.fundamentalNoteSet)this.fundamentalNoteSet=!1,this.scale.fundamentalNote=t.data[1],this.scale.fundamentalFrequency=this.midiToFrequency(t.data[1]),this.noteDisplay.innerHTML=this.scale.fundamentalNote,this.frequencyDisplay.innerHTML=this.scale.fundamentalFrequency.toFixed(2),this.log("Fundamental note set:",this.scale.fundamentalNote,"("+this.scale.fundamentalFrequency.toFixed(2)+"Hz)");else if(n||i){var a=this.scale.noteToNasca(t.data[1]),s=e(a,2),u=s[0],c=s[1];if(n){var o=127&c,r=c>>7&127,l=15&t.data[0];this.outputDevice.send([224+l,o,r])}this.outputDevice.send([t.data[0],u,t.data[2]])}else this.outputDevice.send(t.data)}}}]),n}();exports.default=u;
},{"./NascaScale":"89/O"}],"vP9g":[function(require,module,exports) {
"use strict";var e=require("./MidiHandler"),n=t(e);function t(e){return e&&e.__esModule?e:{default:e}}var d=function(){for(var e=arguments.length,n=Array(e),t=0;t<e;t++)n[t]=arguments[t];var d=document.getElementById("logs");d.innerHTML+=n.join(" ")+"\n",d.scrollTop=d.scrollHeight};window.onload=function(){window.handler=new n.default(document.getElementById("input-devices"),document.getElementById("output-devices"),document.getElementById("note"),document.getElementById("frequency"),document.getElementById("set-note"),d)};
},{"./MidiHandler":"CGw3"}]},{},["vP9g"], null)
//# sourceMappingURL=application.14bc37f8.map